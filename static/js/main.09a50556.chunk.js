(this.webpackJsonpschoolchan=this.webpackJsonpschoolchan||[]).push([[0],[,,,,,,,function(e,t,a){e.exports=a.p+"static/media/racoon_male.9eabe416.svg"},,,,,,,function(e,t,a){e.exports=a.p+"static/media/arrow.1d027598.svg"},function(e,t,a){e.exports=a.p+"static/media/backButton.49052b35.svg"},,function(e,t,a){e.exports=a.p+"static/media/image_icon.eae12adf.svg"},function(e,t,a){e.exports=a.p+"static/media/online.86d4e583.svg"},,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/uploadImage.af8867ce.svg"},,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/chatIco.4195cd04.svg"},function(e,t,a){e.exports=a.p+"static/media/userIco.c95fa3fe.svg"},function(e,t,a){e.exports=a.p+"static/media/newChat.d9414f81.svg"},,function(e,t,a){e.exports=a.p+"static/media/report.b7a16ce7.svg"},function(e,t,a){e.exports=a.p+"static/media/backIco.8bf6e5a8.svg"},function(e,t,a){e.exports=a.p+"static/media/addIco.a83663f3.svg"},,function(e,t,a){e.exports=a.p+"static/media/closeIco.6be77778.svg"},function(e,t,a){e.exports=a.p+"static/media/formIco.db5ef68f.svg"},function(e,t,a){e.exports=a.p+"static/media/uploadImageDone.3e48864c.svg"},function(e,t,a){e.exports=a.p+"static/media/uploadImageLoading.52447787.svg"},function(e,t,a){e.exports=a.p+"static/media/all.e487a034.svg"},function(e,t,a){e.exports=a.p+"static/media/sendMessage.3ee2f767.svg"},function(e,t,a){e.exports=a(126)},,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function c(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var r=a(8),l=a.n(r),i=(a(69),a(5)),u=a(28),m=a.n(u),p="https://schoolchan.herokuapp.com",f=localStorage.getItem("token"),d=m()(p,{query:"token=".concat(f)}),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOCKET":return m()(p,{query:"token=".concat(localStorage.getItem("token"))});case"RESET_SOCKET":default:return e}},_=a(19),h=a(3),b={posts:[],postsLastId:"",myPosts:[]},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POSTS":return Object(h.a)({},e,{posts:t.posts,postsLastId:t.postsLastId});case"SET_MY_POSTS":return Object(h.a)({},e,{myPosts:t.myPosts});case"ADD_POSTS":return Object(h.a)({},e,{posts:e.posts.concat(t.post),postsLastId:t.postsLastId});case"ADD_POST":return Object(h.a)({},e,{posts:[].concat(Object(_.a)(e.posts),[t.post])});default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;default:return e}},N={messages:[],messagesLastId:""},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGES":return Object(h.a)({},e,{messages:t.messages,messagesLastId:t.messagesLastId});case"RESET_MESSAGES":return{messages:[]};case"ADD_MESSAGES":return Object(h.a)({},e,{messages:[].concat(Object(_.a)(e.messages),[t.message])});case"ADD_MORE_MESSAGES":return Object(h.a)({},e,{messages:t.moreMessages.reverse().concat(e.messages),messagesLastId:t.messagesLastId});default:return e}},O=Object(i.b)({socket:g,posts:E,userInfo:v,messages:w}),j=a(2),k=function(e){return{type:"SET_SOCKET",socket:e}},y=a(1),S=(a(105),a(14)),P=a.n(S),T=function(e){var t=e.switchFormState,a=Object(n.useState)(""),s=Object(y.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(""),i=Object(y.a)(l,2),u=i[0],m=i[1],p=Object(n.useState)(""),f=Object(y.a)(p,2),d=f[0],g=f[1],_=Object(n.useState)(""),h=Object(y.a)(_,2),b=h[0],E=h[1],v=Object(n.useState)(""),N=Object(y.a)(v,2),w=N[0],O=N[1],j=Object(n.useState)(""),k=Object(y.a)(j,2),S=k[0],T=k[1],C={username:c,school:u,repassword:d,password:b};return o.a.createElement("div",{className:"register"},o.a.createElement("div",null,o.a.createElement("h1",{className:"register__title"},"Stw\xf3rz nowe konto"),o.a.createElement("h2",{className:"register__text"},"Trzymaj kontakt anonimowo ze spo\u0142eczno\u015bci\u0105 swojej szko\u0142y.")),o.a.createElement("form",{className:"register__form",onSubmit:function(e){fetch("".concat("https://schoolchan.herokuapp.com","/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then((function(e){return e.json()})).then((function(e){var a;console.log("Response:",e),"MissingUsernameError"===(a=e.name)?(O("Podaj nazw\u0119 uzytkownika"),T("username")):"MissingPasswordError"===a?(O("Wpisz has\u0142o"),T("password")):"PasswordsDoNotMatch"===a?(O("Podane has\u0142a nie s\u0105 takie same"),T("repassword")):"UserExistsError"===a?(O("Ten pseudonim juz jest zaj\u0119ty"),T("username")):"NoSchoolSelected"===a?(O("Wybierz szko\u0142\u0119"),T("school")):"AccountCreated"===a?t("login"):a?(O("Nieznany b\u0142\u0105d"),T("repassword")):t("login")})).catch((function(e){console.error("Error:",e)})),e.preventDefault()}},o.a.createElement("input",{type:"text",name:"username",placeholder:"Pseudonim",className:"register__input",value:c,onChange:function(e){return r(e.target.value)}}),o.a.createElement("span",{className:"register__error"},"username"===S?w:null),o.a.createElement("select",{name:"school",placeholder:"Wybierz szko\u0142e",className:"register__input",value:u,onChange:function(e){return m(e.target.value)}},o.a.createElement("option",{value:!0,hidden:!0},"Wybierz szko\u0142e"),o.a.createElement("option",{value:"kili\u0144skiego"},"kili\u0144skiego"),o.a.createElement("option",{value:"test"},"test")),o.a.createElement("span",{className:"register__error"},"school"===S?w:null),o.a.createElement("input",{type:"password",name:"password",placeholder:"Has\u0142o",className:"register__input",value:b,onChange:function(e){return E(e.target.value)}}),o.a.createElement("span",{className:"register__error"},"password"===S?w:null),o.a.createElement("input",{type:"password",name:"repassword",placeholder:"Powt\xf3rz has\u0142o",className:"register__input",value:d,onChange:function(e){return g(e.target.value)}}),o.a.createElement("span",{className:"register__error"},"repassword"===S?w:null),o.a.createElement("div",{className:"register__buttons"},o.a.createElement("button",{type:"button",className:"register__loginButton",onClick:function(){return t("login")}},o.a.createElement("p",{className:"register__loginText"},"Masz ju\u017c konto?"),o.a.createElement("p",{className:"register__loginTextBlue"},"Zaloguj si\u0119")),o.a.createElement("button",{className:"register__registerButton"},"Zarejestruj si\u0119 ",o.a.createElement("img",{src:P.a,alt:""})))))},C=function(e,t,a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var o="expires= ".concat(n.toUTCString());document.cookie="".concat(e,"=").concat(t,";").concat(o,";path=/")},I=(a(106),function(e){var t=e.switchFormState,a=Object(n.useState)(""),s=Object(y.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(""),i=Object(y.a)(l,2),u=i[0],m=i[1],p=Object(n.useState)(""),f=Object(y.a)(p,2),d=f[0],g=f[1],_=Object(n.useState)(!1),h=Object(y.a)(_,2),b=h[0],E=h[1],v=Object(j.c)(),N=function(e){for(var t="".concat(e,"="),a=decodeURIComponent(document.cookie).split(";"),n=0;n<a.length;n+=1){for(var o=a[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""}("token"),w=function(e){400===e?g("Wpisz dane logowania"):401===e?g("Wpisane login lub has\u0142o s\u0105 nieprawid\u0142owe"):404!==e&&403!==e||g("Serwery aktualnie s\u0105 niedost\u0119pne. Prosz\u0119 spr\xf3bowa\u0107 ponownie p\xf3\u017aniej.")},O={username:c,password:u};return N.length>0&&(localStorage.setItem("token",O.token),v(k())),o.a.createElement("div",{className:"login"},o.a.createElement("h1",{className:"login__title"},"Logowanie"),o.a.createElement("form",{className:"login__form",onSubmit:function(e){fetch("".concat("https://schoolchan.herokuapp.com","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)}).then((function(e){return w(e.status),e.json()})).then((function(e){e.message?console.log("Z\u0142e dane"):(localStorage.setItem("token",e.token),b&&C("token",e.token,7),v(k()))})).catch((function(e){"TypeError: Failed to fetch"==e&&w(404)})),e.preventDefault()}},o.a.createElement("input",{type:"text",placeholder:"Pseudonim",className:"login__input",value:c,onChange:function(e){return r(e.target.value)}}),o.a.createElement("input",{type:"password",placeholder:"Has\u0142o",className:"login__input",value:u,onChange:function(e){return m(e.target.value)}}),o.a.createElement("span",{className:"login__error"},d),o.a.createElement("div",{className:"login__underInputs"},o.a.createElement("button",{type:"button",className:"login__forgotPassword"},"Zapomnia\u0142e\u015b has\u0142a?"),o.a.createElement("label",{className:"login__remember",htmlFor:"remember"},o.a.createElement("input",{type:"checkbox",name:"remember",className:"login__rememberCheckbox",onChange:function(e){return E(e.target.checked)},checked:b}),"Pami\u0119taj mnie")),o.a.createElement("button",{type:"submit",className:"login__loginButton"},"Zaloguj si\u0119 ",o.a.createElement("img",{src:P.a,alt:""})),o.a.createElement("button",{type:"button",className:"login__registerButton",onClick:function(){return t("register")}},"Stw\xf3rz nowe konto")))}),x=(a(107),function(){var e=Object(n.useState)("login"),t=Object(y.a)(e,2),a=t[0],s=t[1];return window.onload=function(){window.location.hash=""},o.a.createElement("div",{className:"start"},o.a.createElement("div",{className:"start__bannerText"},"Pozosta\u0144 anonimowy i wyra\u017a swoje opinie"),o.a.createElement("hr",{className:"start__hr"}),"login"===a?o.a.createElement(I,{switchFormState:s}):o.a.createElement(T,{switchFormState:s}))}),B=a(6),z=a.n(B),F=function(){var e=Object(j.c)(),t=Object(j.d)((function(e){return e.socket}));return Object(n.useEffect)((function(){t&&(t.on("posts",(function(t){var a,n;t.length>0&&e((a=t,n=t[t.length-1]._id,{type:"SET_POSTS",posts:a,postsLastId:n}))})),t.on("post",(function(t){e({type:"ADD_POST",post:t})})),t.on("morePosts",(function(t){var a,n;t.length>0&&e((a=t,n=t[t.length-1]._id,{type:"ADD_POSTS",post:a,postsLastId:n}))})),t.on("myPosts",(function(t){e(function(e){return{type:"SET_MY_POSTS",myPosts:e}}(t))})))}),[e,t]),null},M=function(){var e=Object(j.c)(),t=Object(j.d)((function(e){return e.socket}));return Object(n.useEffect)((function(){t.on("message",(function(t){e(function(e){return{type:"ADD_MESSAGES",message:e}}(t))})),t.on("moreMessages",(function(t){var a,n;t.length>0&&e((a=t,n=t[t.length-1]._id,{type:"ADD_MORE_MESSAGES",moreMessages:a,messagesLastId:n}))}))}),[e,t]),Object(n.useEffect)((function(){t.emit("joinChat","all"),t.on("messages",(function(t){var a,n;t.length>0&&e((a=t,n=t[0]._id,{type:"SET_MESSAGES",messages:a,messagesLastId:n}))}))}),[e,t]),null},D=a(50),R=a.n(D),W=a(51),L=a.n(W),A=a(15),U=a.n(A),G=a(52),H=a.n(G),K=(a(108),function(e){var t=e.setMenu,a=e.forceUpdateMain;return o.a.createElement("div",{className:"topBar"},o.a.createElement("ul",{className:"topBar__optionsList"},"#chat"===window.location.hash?o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--menu",onClick:function(){window.history.back()}},o.a.createElement("img",{src:U.a,alt:""}))):o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--menu",onClick:function(){return t(!0)}},o.a.createElement("img",{src:L.a,alt:""}))),o.a.createElement("li",{className:"topBar__options topBar__options--banner"},"schoolchan"),"#chat"===window.location.hash?o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--chat",onClick:function(){return null}},o.a.createElement("img",{src:H.a,alt:""}))):o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--chat",onClick:function(){window.location.hash="chat",a()}},o.a.createElement("img",{src:R.a,alt:""})))))}),Z=a(53),q=a(13),V=a(7),J=a.n(V),X=a(54),Y=a.n(X),$=function(e){var t=new Date,a=-1*(Date.parse(e)-t.getTime())/6e4;if(a>43829){var n=new Date(e),o=n.getFullYear(),s=n.getMonth()+1,c=n.getDate();return c<10&&(c="0 ".concat(c)),s<10&&(s="0 ".concat(s)),"".concat(c," - ").concat(s," - ").concat(o)}return a>2880?"".concat(Math.ceil(a/1440)," dni temu"):a>1440?"1 dzie\u0144 temu":a>120?"".concat(Math.ceil(a/60),"h temu"):a>60?"godzin\u0119 temu":a>2?"".concat(Math.ceil(a)," min temu"):a?"minut\u0119 temu":"przed chwil\u0105"},Q=a(55),ee=a.n(Q),te=a(16),ae=a.n(te),ne=a(17),oe=a.n(ne),se="DURING",ce="DONE",re=function(e,t,a){a(se);var n=e.current.files[0],o=new FileReader;o.onloadend=function(){!function(e){var n=new Headers;n.append("Content-Type","application/x-www-form-urlencoded");var o=new URLSearchParams;o.append("key","69106b72459a3015d3a83871dde47b63"),o.append("image",e),fetch("https://api.imgbb.com/1/upload",{method:"POST",headers:n,body:o,redirect:"follow"}).then((function(e){return e.json()})).then((function(e){return a(ce),t({large:e.data.image.url,mini:e.data.thumb.url})})).catch((function(e){return console.log("error",e)}))}(o.result.substr(o.result.indexOf(",")+1))},n&&o.readAsDataURL(n)},le=(a(111),function(e){var t=e.focus,a=e.post,s=Object(n.useState)(""),c=Object(y.a)(s,2),r=c[0],l=c[1],i=Object(n.useState)("BEFORE"),u=Object(y.a)(i,2),m=u[0],p=u[1],f=Object(n.useState)(""),d=Object(y.a)(f,2),g=d[0],_=d[1],h=Object(j.d)((function(e){return e.socket})),b=Object(n.useRef)(null),E=Object(n.useRef)(null),v=function(e){if(e.preventDefault(),g.length>0&&"DURING"!==m){var t={image:r,commentText:g,postId:a._id};h.emit("sendComment",t),_(""),l("")}};return ae()(b.current),o.a.createElement("form",{className:"commentForm"},o.a.createElement("label",{htmlFor:"file"},o.a.createElement("img",{src:oe.a,alt:"sendImage"}),o.a.createElement("input",{ref:E,id:"file",className:"commentForm__imageInput",type:"file",accept:"image/x-png,image/jpeg",onChange:function(){return re(E,l,p)}})),o.a.createElement("textarea",{ref:b,autoFocus:t,rows:"1",wrap:"hard",placeholder:"Napisz komentarz...",className:"commentForm__textInput",onChange:function(e){return _(e.target.value)},value:g,onKeyPress:function(e){return"Enter"===e.key?v(e):null}}),o.a.createElement("button",{type:"submit",className:"commentForm__submit",onClick:function(e){return v(e)}},"\u2332"))});le.defaultProps={focus:!1};var ie=le,ue=(a(112),function(e){var t=e.comment;return o.a.createElement("li",{className:"comment"},o.a.createElement("img",{src:J.a,alt:"sex",className:"comment__sex"}),o.a.createElement("div",{className:"comment__text"},o.a.createElement("span",{className:"comment__username"},t.username),"\xa0",t.commentText),"\xa0",t.image?o.a.createElement("a",{href:t.image.large,rel:"noopener noreferrer",target:"_blank"},"Obraz"):null)}),me=(a(113),function(e){var t=e.post,a=e.focus,s=e.postComments,c=e.forceUpdatePost,r=Object(j.d)((function(e){return e.socket})),l=z()();return Object(n.useEffect)((function(){r&&r.on("comment",(function(){l()}))}),[r,l]),window.onhashchange=function(){c()},o.a.createElement("div",{className:"comments"},o.a.createElement("div",{className:"comments__topBar"},o.a.createElement("button",{type:"button",onClick:function(){window.history.back()}},o.a.createElement("img",{src:ee.a,alt:"back",className:"comments__backButtonImg"})),o.a.createElement("div",{className:"comments__title"},"Komentarze")),o.a.createElement("ul",{className:"comments__list"},s.slice(0).reverse().map((function(e){return o.a.createElement(ue,{key:e._id,comment:e})}))),o.a.createElement(ie,{focus:a,post:t}))});me.defaultProps={focus:!1};var pe=me,fe=(a(114),function(e){var t=e.post,a=Object(j.d)((function(e){return e.socket})),s=Object(n.useState)(0),c=Object(y.a)(s,2),r=c[0],l=c[1],i=t.comments,u=t.image,m=t.body,p=t.createdAt,f=t.username,d=t._id,g=t.like,_=t.dislike,b=Object(n.useState)({like:g,dislike:_}),E=Object(y.a)(b,2),v=E[0],N=E[1],w=z()();Object(n.useEffect)((function(){try{l(i.length)}catch(e){l(0)}}),[i.length]),Object(n.useEffect)((function(){a.on("comment",(function(e){d===e.postId&&(l(i.length+1),i.push(e),w())}))}),[i,a,d,w]),Object(n.useEffect)((function(){a.on("newReactionAdd",(function(e){var t=e.postId,a=e.type,n=e.usernameLike;t===d&&N("like"===a?Object(h.a)({},v,{like:n}):Object(h.a)({},v,{dislike:n}))})),a.on("newReactionSub",(function(e){var t=e.postId,a=e.type,n=e.usernameLike;if(t===d){if("like"===a){var o=g.indexOf(n);g.splice(o,1)}else{var s=_.indexOf(n);_.splice(s,1)}N(Object(h.a)({},v,Object(q.a)({},a,[a].length)))}}))}),[]);var O=function(e){var t={postId:d,type:e};a.emit("reaction",t)};return o.a.createElement("li",{className:"post"},o.a.createElement("img",{src:J.a,alt:"sex",className:"post__sex"}),o.a.createElement("div",{className:"post__content"},o.a.createElement("div",{className:"post__username"},f),o.a.createElement("div",{className:"post__postDate"},$(p)),o.a.createElement("div",{className:"post__body"},m),u&&o.a.createElement("img",{className:"post__image",src:u.large,alt:""}),o.a.createElement("div",{className:"post__buttons"},o.a.createElement("button",{type:"button",className:"post__like",onClick:function(){return O("like")}},"+1"),o.a.createElement("button",{type:"button",className:"post__dislike",onClick:function(){return O("dislike")}},"-1"),o.a.createElement("button",{type:"button",className:"post__commentsButton",onClick:function(){window.location.hash="comments",w()}},0===r?"Napisz komentarz":"Komentarze ".concat(r)))),o.a.createElement("button",{type:"button",className:"post__reportButton"},o.a.createElement("img",{src:Y.a,alt:"report"})),o.a.createElement("div",{className:"post__bottom"},o.a.createElement("hr",{className:"post__hr"}),o.a.createElement("div",null,o.a.createElement("div",{className:"post__votes"},o.a.createElement("span",{className:"post__reactions"},v.like.length),o.a.createElement("span",null,"\xa0szop\xf3w jest za, a\xa0"),o.a.createElement("span",{className:"post__reactions"},v.dislike.length),o.a.createElement("span",null,"\xa0przeciw")),o.a.createElement("ul",{className:"post__comments"},i.slice(0).reverse().slice(0,3).map((function(e){return o.a.createElement("li",{key:e._id},o.a.createElement("span",{className:"post__username"},e.username)," ",e.commentText)})),r>3?o.a.createElement("li",null,o.a.createElement("button",{type:"button",className:"post__showAllButton",onClick:function(){window.location.hash="comments",w()}},"Zobacz wszystkie")):null))),"#comments"===window.location.hash?o.a.createElement(pe,{forceUpdatePost:w,post:t,postComments:i,focus:0===r}):null)}),de=(a(115),function(e){var t=e.postType,a=e.posts,n=!1,s=Object(j.d)((function(e){return e.socket}));return Object(Z.useScrollPosition)((function(e){var t=e.currPos,o=document.body.offsetHeight-window.innerHeight+t.y;!n&&o<0&&(s.emit("getMorePosts",a.postsLastId),n=!0)}),[a],null,!1,300),o.a.createElement("ul",{className:"posts"},a[t].map((function(e){return o.a.createElement(fe,{key:e._id,post:e})})))});de.defaultProps={postType:"posts"};var ge=Object(j.b)((function(e){return e}))(de),_e=a(56),he=a.n(_e),be=a(57),Ee=a.n(be),ve=a(58),Ne=a.n(ve),we=a(59),Oe=a.n(we),je=a(31),ke=a.n(je),ye=a(60),Se=a.n(ye),Pe=a(61),Te=a.n(Pe),Ce=(a(116),function(e){var t=e.setCreatePostFrom,a=Object(n.useState)(""),s=Object(y.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(""),i=Object(y.a)(l,2),u=i[0],m=i[1],p=Object(n.useState)("BEFORE"),f=Object(y.a)(p,2),d=f[0],g=f[1],_=Object(j.d)((function(e){return e.socket})),h=Object(n.useRef)(null);return o.a.createElement(Ee.a,{axis:"y",handle:".createPostForm__handle"},o.a.createElement("div",{className:"createPostForm"},o.a.createElement("div",{className:"createPostForm__handle"},o.a.createElement("div",null,o.a.createElement("img",{className:"createPostForm__formIco",src:Oe.a,alt:"createPost"}),o.a.createElement("span",{className:"createPostForm__handleTitle"},"Utw\xf3rz post")),o.a.createElement("button",{type:"button",className:"createPostForm__closeButton",onClick:function(){t(!1)}},o.a.createElement("img",{src:Ne.a,alt:"closeForm"}))),o.a.createElement("form",{action:"",className:"createPostForm__form"},o.a.createElement("div",{className:"createPostForm__label"},"Tre\u015b\u0107:"),o.a.createElement("textarea",{name:"body",className:"createPostForm__postBody",rows:"8",placeholder:"Napisz co\u015b...",onChange:function(e){return r(e.target.value)},value:c}),o.a.createElement("div",{className:"createPostForm__label"},"Obraz:"),o.a.createElement("label",{className:"createPostForm__labelButtonStyle",htmlFor:"file"},o.a.createElement("img",{src:function(){switch(d){case"BEFORE":return ke.a;case"DURING":return Te.a;case"DONE":return Se.a;default:return ke.a}}(),alt:"upload",className:"createPostForm__uploadImg"}),o.a.createElement("input",{ref:h,className:"createPostForm__imageButton",name:"image",type:"file",accept:"image/x-png,image/jpeg",id:"file",onChange:function(){return re(h,m,g)}})),o.a.createElement("button",{type:"submit",className:"createPostForm__submit",onClick:function(e){return function(e){e.preventDefault();var a={body:c,image:u};a&&(_.emit("sendPost",a),t(!1))}(e)}},"Opublikuj"))))});Ce.defaultProps={setCreatePostFrom:function(){return 0}};var Ie=Ce,xe=(a(117),function(){var e=Object(n.useState)(!1),t=Object(y.a)(e,2),a=t[0],s=t[1];return o.a.createElement("div",{className:"createPost"},a?o.a.createElement(Ie,{setCreatePostFrom:s}):o.a.createElement("button",{type:"button",className:"createPost__button",onClick:function(){return s(!0)}},o.a.createElement("img",{src:he.a,alt:""})))}),Be=(a(118),function(e){var t=e.postType,a={display:"block"};return""!==window.location.hash?a.display="none":a.display="block",o.a.createElement("div",{style:a,className:"chan"},o.a.createElement(ge,{postType:t}),o.a.createElement(xe,null))});Be.defaultProps={postType:"posts"};var ze=Be,Fe=a(62),Me=a.n(Fe),De=a(18),Re=a.n(De),We=(a(119),function(e){var t=e.chatWith,a=e.setChatWith;return o.a.createElement("div",{className:"topBarChat"},o.a.createElement("button",{type:"button",className:"topBarChat__backButton",onClick:function(){a(""),window.history.back()}},o.a.createElement("img",{src:U.a,alt:"back"})),o.a.createElement("div",{className:"topBarChat__title"},t),o.a.createElement("div",{className:"topBarChat__online"},o.a.createElement("div",{className:"topBarChat__onlineNumber"},"1"),o.a.createElement("img",{src:Re.a,alt:"online"})))}),Le=(a(120),function(e){var t=e.message,a=e.isMy;return o.a.createElement("div",{className:"message ".concat(a?"message--end":null)},o.a.createElement("div",{className:"message__speechBubble ".concat(a?"message__speechBubble--end":null)},t.body,t.image.mini&&o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{href:t.image.large,target:"_blank",rel:"noopener noreferrer"},o.a.createElement("img",{src:t.image.mini,alt:""})))),o.a.createElement("div",{className:"message__username"},t.username))}),Ae=(a(121),Object(j.b)((function(e){return e}))((function(e){var t=e.messages,a=!1,s=Object(j.d)((function(e){return e.socket})),c=Object(j.d)((function(e){return e.userInfo.username})),r=Object(n.useState)(!0),l=Object(y.a)(r,2),i=l[0],u=l[1],m=Object(n.useRef)(null),p=Object(n.useRef)(null),f=Object(n.useRef)(null),d=function(e){"smooth"===e?m.current.scrollIntoView({behavior:"smooth"}):"fast"===e&&m.current.scrollIntoView()};return Object(n.useEffect)((function(){d("fast")}),[]),Object(n.useEffect)((function(){var e=p.current,n=f.current,o=document.querySelectorAll(".message");if(e&&o.length>5){for(var s,c=0;c<5;c+=1)s=o[c].offsetHeight;setInterval((function(){var o=e.scrollTop;!a&&t.messages.length>14&&o<50&&(e.scrollTop=o+s,n.click())}),1e3)}}),[t]),Object(n.useEffect)((function(){var e=document.querySelectorAll(".message"),t=p.current,a=t.scrollHeight,n=t.scrollTop,o=t.offsetHeight;if(e.length>0){var s=a-n-o-e[e.length-1].offsetHeight-24;u(s<100)}i&&d("smooth")}),[t]),o.a.createElement("div",{className:"messages"},o.a.createElement("div",{ref:p,className:"messages__scroll"},o.a.createElement("button",{ref:f,type:"button",className:"messages__loadMoreButton",onClick:function(){return a=!0,void s.emit("getMoreMessages",t.messagesLastId)}}),t.messages.map((function(e){return o.a.createElement(Le,{key:e._id,message:e,isMy:e.username===c})})),o.a.createElement("div",{ref:m,id:"bottom"})))}))),Ue=a(63),Ge=a.n(Ue),He=(a(122),function(){var e=Object(j.d)((function(e){return e.socket})),t=Object(n.useState)(""),a=Object(y.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)(""),l=Object(y.a)(r,2),i=l[0],u=l[1],m=Object(n.useState)("BEFORE"),p=Object(y.a)(m,2),f=p[0],d=p[1],g=Object(n.useRef)(null),_=Object(n.useRef)(null);ae()(g.current);var h=function(t){t.preventDefault(),function(){if("DURING"!==f){var t={messageText:s,messageImage:i};e.emit("sendMessage",t),c(""),u("")}}()};return o.a.createElement("div",{className:"messageForm"},o.a.createElement("label",{className:"messageForm__sendImageButton",htmlFor:"file"},o.a.createElement("input",{ref:_,className:"messageForm__sendImageInput",type:"file",id:"file",onChange:function(){return re(_,u,d)}}),o.a.createElement("img",{src:oe.a,alt:""})),o.a.createElement("textarea",{ref:g,className:"messageForm__textarea",rows:"1",wrap:"hard",placeholder:"Napisz wiadomo\u015b\u0107...",onChange:function(e){return c(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?h(e):null},value:s,onFocus:function(){document.querySelector("#bottom").scrollIntoView()}}),o.a.createElement("button",{type:"button",className:"messageForm__sendMessageButton",onClick:function(e){return h(e)}},o.a.createElement("img",{src:Ge.a,alt:""})))}),Ke=(a(123),function(e){var t=e.chatWith,a=e.setChatWith;return o.a.createElement("div",{className:"conversation"},o.a.createElement(We,{chatWith:t,setChatWith:a}),o.a.createElement(Ae,{chatWith:t}),o.a.createElement(He,{chatWith:t}))});Ke.defaultProps={chatWith:"all",setChatWith:function(){return 0}};var Ze=Ke,qe=(a(124),function(e){var t=e.forceUpdateMain,a=Object(n.useState)(""),s=Object(y.a)(a,2),c=s[0],r=s[1];return window.onhashchange=function(){t()},o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"chat"},o.a.createElement("button",{type:"button",className:"chat__all",onClick:function(){r("all"),window.location.hash+="/#all"}},o.a.createElement("div",{className:"chat__allHeader"},o.a.createElement("img",{src:Me.a,alt:"wtf"}),o.a.createElement("div",{className:"chat__allTitle"},"Wszyscy")),o.a.createElement("div",{className:"chat__allOnline"},o.a.createElement("div",{className:"chat__allOnlineNumber"},"0"),o.a.createElement("img",{src:Re.a,alt:""}))),o.a.createElement("ul",null,o.a.createElement("li",null,"Tu znajd\u0105 si\u0119 Twoje rozmowy z innymi szopami"))),c?o.a.createElement(Ze,{chatWith:c,setChatWith:r}):null)});qe.defaultProps={forceUpdateMain:null};var Ve=qe,Je=(a(125),function(e){var t=e.setMenu,a=e.setPostType,n=e.postType,s=Object(j.d)((function(e){return e.userInfo.username}));return o.a.createElement("aside",{className:"menu"},o.a.createElement("div",{className:"menu__content"},o.a.createElement("div",{className:"menu__header"},o.a.createElement("img",{src:J.a,alt:"profile",className:"menu__profile"}),"Witaj,\xa0",o.a.createElement("span",{className:"menu__username"},s)),o.a.createElement("div",{className:"menu__options"},o.a.createElement("button",{type:"button",className:"menu__option ".concat("posts"===n?"menu__option--chosen":null),onClick:function(){a("posts"),t(!1)}},"Tablica"),o.a.createElement("button",{type:"button",className:"menu__option ".concat("myPosts"===n?"menu__option--chosen":null),onClick:function(){a("myPosts"),t(!1)}},"Moje posty"),o.a.createElement("button",{type:"button",className:"menu__option ".concat("followingPosts"===n?"menu__option--chosen":null),onClick:function(){a("followingPosts"),t(!1)}},"Obserwowane"),o.a.createElement("button",{type:"button",className:"menu__option"},"Sklep"),o.a.createElement("button",{type:"button",className:"menu__option"},"Randka"),o.a.createElement("button",{type:"button",className:"menu__option"},"Ustawienia"),o.a.createElement("button",{type:"button",className:"menu__option menu__option--logout",onClick:function(){return localStorage.setItem("token",null),C("token","",0),void window.location.reload()}},"Wyloguj"))),o.a.createElement("div",{className:"menu__bg",onClick:function(){return t(!1)}}))});Je.defaultProps={postType:"posts"};var Xe=Je,Ye=function(){var e=z()(),t=Object(n.useState)(!1),a=Object(y.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)("posts"),l=Object(y.a)(r,2),i=l[0],u=l[1];return window.onload=function(){window.location.hash=""},o.a.createElement("div",null,o.a.createElement(F,null),o.a.createElement(M,null),o.a.createElement(K,{setMenu:c,forceUpdateMain:e}),window.location.hash.indexOf("chat")>0?o.a.createElement(Ve,{forceUpdateMain:e}):null,s?o.a.createElement(Xe,{setMenu:c,setPostType:u,postType:i}):null,o.a.createElement(ze,{postType:i}))},$e=a(32),Qe=a.n($e),et=function(){var e=Object(j.c)(),t=Object(j.d)((function(e){return e.socket})),a=Object(j.d)((function(e){return e.socket.connected}));Object(n.useEffect)((function(){t&&(t.on("error",(function(e){e&&localStorage.removeItem("token")})),t.on("connect",(function(){})),t.on("userInfo",(function(a){e({type:"SET_USER",user:a}),t.emit("joinChan",(function(e){}))})),t.on("connect_error",(function(){localStorage.removeItem("token")})))}),["https://schoolchan.herokuapp.com",e,t]);return o.a.createElement(o.a.Fragment,null,function(){if(Qe()()){if(a)return o.a.createElement(Ye,null);if(!a)return o.a.createElement(x,null)}if(!Qe()()){if(a)return"noMobileLogged";if(!a)return"noMobileNoLogged"}return null}())},tt=Object(i.c)(O,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());l.a.render(o.a.createElement(j.a,{store:tt},o.a.createElement(et,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):c(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):c(t,e)}))}}(),"serviceWorker"in navigator&&(console.log("Will the service worker register?"),navigator.serviceWorker.register("./serviceWorker.js").then((function(e){console.log("Yes, it did.")})).catch((function(e){console.log("No it didn't. This happened: ",e)})))}],[[64,1,2]]]);
//# sourceMappingURL=main.09a50556.chunk.js.map