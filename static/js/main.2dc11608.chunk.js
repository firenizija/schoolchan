(this.webpackJsonpschoolchan=this.webpackJsonpschoolchan||[]).push([[0],[,,,,,,,function(e,t,a){e.exports=a.p+"static/media/racoon_male.9eabe416.svg"},,,,,,,function(e,t,a){e.exports=a.p+"static/media/arrow.1d027598.svg"},function(e,t,a){e.exports=a.p+"static/media/backButton.49052b35.svg"},function(e,t,a){e.exports=a.p+"static/media/image_icon.eae12adf.svg"},function(e,t,a){e.exports=a.p+"static/media/online.86d4e583.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a.p+"static/media/chatIco.4195cd04.svg"},function(e,t,a){e.exports=a.p+"static/media/userIco.c95fa3fe.svg"},function(e,t,a){e.exports=a.p+"static/media/newChat.d9414f81.svg"},,function(e,t,a){e.exports=a.p+"static/media/report.b7a16ce7.svg"},function(e,t,a){e.exports=a.p+"static/media/backIco.8bf6e5a8.svg"},function(e,t,a){e.exports=a.p+"static/media/addIco.a83663f3.svg"},,function(e,t,a){e.exports=a.p+"static/media/closeIco.6be77778.svg"},function(e,t,a){e.exports=a.p+"static/media/formIco.db5ef68f.svg"},function(e,t,a){e.exports=a.p+"static/media/uploadImage.af8867ce.svg"},function(e,t,a){e.exports=a.p+"static/media/uploadImageDone.3e48864c.svg"},function(e,t,a){e.exports=a.p+"static/media/all.e487a034.svg"},function(e,t,a){e.exports=a.p+"static/media/sendMessage.3ee2f767.svg"},function(e,t,a){e.exports=a(124)},,,,,function(e,t,a){},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function c(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var r=a(9),l=a.n(r),i=(a(67),a(5)),m=a(27),u=a.n(m),p="https://schoolchan.herokuapp.com",d=localStorage.getItem("token"),f=u()(p,{query:"token=".concat(d)}),_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOCKET":return u()(p,{query:"token=".concat(localStorage.getItem("token"))});case"RESET_SOCKET":default:return e}},g=a(18),h=a(3),b={posts:[],postsLastId:"",myPosts:[]},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POSTS":return Object(h.a)({},e,{posts:t.posts,postsLastId:t.postsLastId});case"SET_MY_POSTS":return Object(h.a)({},e,{myPosts:t.myPosts});case"ADD_POSTS":return Object(h.a)({},e,{posts:e.posts.concat(t.post),postsLastId:t.postsLastId});case"ADD_POST":return Object(h.a)({},e,{posts:[].concat(Object(g.a)(e.posts),[t.post])});default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;default:return e}},w={messages:[],messagesLastId:""},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGES":return Object(h.a)({},e,{messages:t.messages,messagesLastId:t.messagesLastId});case"RESET_MESSAGES":return{messages:[]};case"ADD_MESSAGES":return Object(h.a)({},e,{messages:[].concat(Object(g.a)(e.messages),[t.message])});case"ADD_MORE_MESSAGES":return Object(h.a)({},e,{messages:t.moreMessages.reverse().concat(e.messages),messagesLastId:t.messagesLastId});default:return e}},y=Object(i.b)({socket:_,posts:E,userInfo:v,messages:N}),k=a(2),S=function(e){return{type:"SET_SOCKET",socket:e}},O=a(1),j=(a(103),a(14)),P=a.n(j),T=function(e){var t=e.switchFormState,a=Object(n.useState)(""),s=Object(O.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(""),i=Object(O.a)(l,2),m=i[0],u=i[1],p=Object(n.useState)(""),d=Object(O.a)(p,2),f=d[0],_=d[1],g=Object(n.useState)(""),h=Object(O.a)(g,2),b=h[0],E=h[1],v=Object(n.useState)(""),w=Object(O.a)(v,2),N=w[0],y=w[1],k=Object(n.useState)(""),S=Object(O.a)(k,2),j=S[0],T=S[1],C={username:c,school:m,repassword:f,password:b};return o.a.createElement("div",{className:"register"},o.a.createElement("div",null,o.a.createElement("h1",{className:"register__title"},"Stw\xf3rz nowe konto"),o.a.createElement("h2",{className:"register__text"},"Trzymaj kontakt anonimowo ze spo\u0142eczno\u015bci\u0105 swojej szko\u0142y.")),o.a.createElement("form",{className:"register__form",onSubmit:function(e){fetch("".concat("https://schoolchan.herokuapp.com","/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}).then((function(e){return e.json()})).then((function(e){var a;console.log("Response:",e),"MissingUsernameError"===(a=e.name)?(y("Podaj nazw\u0119 uzytkownika"),T("username")):"MissingPasswordError"===a?(y("Wpisz has\u0142o"),T("password")):"PasswordsDoNotMatch"===a?(y("Podane has\u0142a nie s\u0105 takie same"),T("repassword")):"UserExistsError"===a?(y("Ten pseudonim juz jest zaj\u0119ty"),T("username")):"NoSchoolSelected"===a?(y("Wybierz szko\u0142\u0119"),T("school")):"AccountCreated"===a?t("login"):a?(y("Nieznany b\u0142\u0105d"),T("repassword")):t("login")})).catch((function(e){console.error("Error:",e)})),e.preventDefault()}},o.a.createElement("input",{type:"text",name:"username",placeholder:"Pseudonim",className:"register__input",value:c,onChange:function(e){return r(e.target.value)}}),o.a.createElement("span",{className:"register__error"},"username"===j?N:null),o.a.createElement("select",{name:"school",placeholder:"Wybierz szko\u0142e",className:"register__input",value:m,onChange:function(e){return u(e.target.value)}},o.a.createElement("option",{value:!0,hidden:!0},"Wybierz szko\u0142e"),o.a.createElement("option",{value:"kili\u0144skiego"},"kili\u0144skiego"),o.a.createElement("option",{value:"test"},"test")),o.a.createElement("span",{className:"register__error"},"school"===j?N:null),o.a.createElement("input",{type:"password",name:"password",placeholder:"Has\u0142o",className:"register__input",value:b,onChange:function(e){return E(e.target.value)}}),o.a.createElement("span",{className:"register__error"},"password"===j?N:null),o.a.createElement("input",{type:"password",name:"repassword",placeholder:"Powt\xf3rz has\u0142o",className:"register__input",value:f,onChange:function(e){return _(e.target.value)}}),o.a.createElement("span",{className:"register__error"},"repassword"===j?N:null),o.a.createElement("div",{className:"register__buttons"},o.a.createElement("button",{type:"button",className:"register__loginButton",onClick:function(){return t("login")}},o.a.createElement("p",{className:"register__loginText"},"Masz ju\u017c konto?"),o.a.createElement("p",{className:"register__loginTextBlue"},"Zaloguj si\u0119")),o.a.createElement("button",{className:"register__registerButton"},"Zarejestruj si\u0119 ",o.a.createElement("img",{src:P.a,alt:""})))))},C=function(e,t,a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var o="expires= ".concat(n.toUTCString());document.cookie="".concat(e,"=").concat(t,";").concat(o,";path=/")},x=(a(104),function(e){var t=e.switchFormState,a=Object(n.useState)(""),s=Object(O.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(""),i=Object(O.a)(l,2),m=i[0],u=i[1],p=Object(n.useState)(""),d=Object(O.a)(p,2),f=d[0],_=d[1],g=Object(n.useState)(!1),h=Object(O.a)(g,2),b=h[0],E=h[1],v=Object(k.c)(),w=function(e){for(var t="".concat(e,"="),a=decodeURIComponent(document.cookie).split(";"),n=0;n<a.length;n+=1){for(var o=a[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""}("token"),N=function(e){400===e?_("Wpisz dane logowania"):401===e?_("Wpisane login lub has\u0142o s\u0105 nieprawid\u0142owe"):404!==e&&403!==e||_("Serwery aktualnie s\u0105 niedost\u0119pne. Prosz\u0119 spr\xf3bowa\u0107 ponownie p\xf3\u017aniej.")},y={username:c,password:m};return w.length>0&&(localStorage.setItem("token",y.token),v(S())),o.a.createElement("div",{className:"login"},o.a.createElement("h1",{className:"login__title"},"Logowanie"),o.a.createElement("form",{className:"login__form",onSubmit:function(e){fetch("".concat("https://schoolchan.herokuapp.com","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}).then((function(e){return N(e.status),e.json()})).then((function(e){e.message?console.log("Z\u0142e dane"):(localStorage.setItem("token",e.token),b&&C("token",e.token,7),v(S()))})).catch((function(e){"TypeError: Failed to fetch"==e&&N(404)})),e.preventDefault()}},o.a.createElement("input",{type:"text",placeholder:"Pseudonim",className:"login__input",value:c,onChange:function(e){return r(e.target.value)}}),o.a.createElement("input",{type:"password",placeholder:"Has\u0142o",className:"login__input",value:m,onChange:function(e){return u(e.target.value)}}),o.a.createElement("span",{className:"login__error"},f),o.a.createElement("div",{className:"login__underInputs"},o.a.createElement("button",{type:"button",className:"login__forgotPassword"},"Zapomnia\u0142e\u015b has\u0142a?"),o.a.createElement("label",{className:"login__remember",htmlFor:"remember"},o.a.createElement("input",{type:"checkbox",name:"remember",className:"login__rememberCheckbox",onChange:function(e){return E(e.target.checked)},checked:b}),"Pami\u0119taj mnie")),o.a.createElement("button",{type:"submit",className:"login__loginButton"},"Zaloguj si\u0119 ",o.a.createElement("img",{src:P.a,alt:""})),o.a.createElement("button",{type:"button",className:"login__registerButton",onClick:function(){return t("register")}},"Stw\xf3rz nowe konto")))}),I=(a(105),function(){var e=Object(n.useState)("login"),t=Object(O.a)(e,2),a=t[0],s=t[1];return window.onload=function(){window.location.hash=""},o.a.createElement("div",{className:"start"},o.a.createElement("div",{className:"start__bannerText"},"Pozosta\u0144 anonimowy i wyra\u017a swoje opinie"),o.a.createElement("hr",{className:"start__hr"}),"login"===a?o.a.createElement(x,{switchFormState:s}):o.a.createElement(T,{switchFormState:s}))}),B=a(6),z=a.n(B),M=function(){var e=Object(k.c)(),t=Object(k.d)((function(e){return e.socket}));return Object(n.useEffect)((function(){t&&(t.on("posts",(function(t){var a,n;t.length>0&&e((a=t,n=t[t.length-1]._id,{type:"SET_POSTS",posts:a,postsLastId:n}))})),t.on("post",(function(t){e({type:"ADD_POST",post:t})})),t.on("morePosts",(function(t){var a,n;t.length>0&&e((a=t,n=t[t.length-1]._id,{type:"ADD_POSTS",post:a,postsLastId:n}))})),t.on("myPosts",(function(t){e(function(e){return{type:"SET_MY_POSTS",myPosts:e}}(t))})))}),[e,t]),null},F=function(){var e=Object(k.c)(),t=Object(k.d)((function(e){return e.socket}));return Object(n.useEffect)((function(){t.on("message",(function(t){e(function(e){return{type:"ADD_MESSAGES",message:e}}(t))})),t.on("moreMessages",(function(t){var a,n;t.length>0&&e((a=t,n=t[t.length-1]._id,{type:"ADD_MORE_MESSAGES",moreMessages:a,messagesLastId:n}))}))}),[e,t]),Object(n.useEffect)((function(){t.emit("joinChat","all"),t.on("messages",(function(t){var a,n;t.length>0&&e((a=t,n=t[0]._id,{type:"SET_MESSAGES",messages:a,messagesLastId:n}))}))}),[e,t]),null},D=a(48),W=a.n(D),A=a(49),L=a.n(A),U=a(15),R=a.n(U),q=a(50),H=a.n(q),G=(a(106),function(e){var t=e.setMenu,a=e.forceUpdateMain;return o.a.createElement("div",{className:"topBar"},o.a.createElement("ul",{className:"topBar__optionsList"},"#chat"===window.location.hash?o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--menu",onClick:function(){window.history.back()}},o.a.createElement("img",{src:R.a,alt:""}))):o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--menu",onClick:function(){return t(!0)}},o.a.createElement("img",{src:L.a,alt:""}))),o.a.createElement("li",{className:"topBar__options topBar__options--banner"},"schoolchan"),"#chat"===window.location.hash?o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--chat",onClick:function(){return null}},o.a.createElement("img",{src:H.a,alt:""}))):o.a.createElement("li",{className:"topBar__options topBar__options--button"},o.a.createElement("button",{className:"topBar__button topBar__button--chat",onClick:function(){window.location.hash="chat",a()}},o.a.createElement("img",{src:W.a,alt:""})))))}),K=a(51),Z=a(7),V=a.n(Z),J=a(52),X=a.n(J),Y=function(e){var t=new Date,a=-1*(Date.parse(e)-t.getTime())/6e4;if(a>43829){var n=new Date(e),o=n.getFullYear(),s=n.getMonth()+1,c=n.getDate();return c<10&&(c="0 ".concat(c)),s<10&&(s="0 ".concat(s)),"".concat(c," - ").concat(s," - ").concat(o)}return a>2880?"".concat(Math.ceil(a/1440)," dni temu"):a>1440?"1 dzie\u0144 temu":a>120?"".concat(Math.ceil(a/60),"h temu"):a>60?"godzin\u0119 temu":a>2?"".concat(Math.ceil(a)," min temu"):a?"minut\u0119 temu":"przed chwil\u0105"},$=a(53),Q=a.n($),ee=a(8),te=a.n(ee),ae=a(16),ne=a.n(ae),oe=(a(109),function(e){var t=e.focus,a=e.post,s=Object(n.useState)(""),c=Object(O.a)(s,2),r=c[0],l=c[1],i=Object(n.useState)(""),m=Object(O.a)(i,2),u=m[0],p=m[1],d=Object(k.d)((function(e){return e.socket})),f=function(e){e.preventDefault();var t={image:r,commentText:u,postId:a._id};d.emit("sendComment",t),p(""),l("")},_=function(e){var t=e.target.files[0],a=new FileReader;a.onloadend=function(){!function(e){var t=new Headers;t.append("Content-Type","application/x-www-form-urlencoded");var a=new URLSearchParams;a.append("key","69106b72459a3015d3a83871dde47b63"),a.append("image",e),fetch("https://api.imgbb.com/1/upload",{method:"POST",headers:t,body:a,redirect:"follow"}).then((function(e){return e.json()})).then((function(e){l({large:e.data.image.url,mini:e.data.thumb.url})})).catch((function(e){return console.log("error",e)}))}(a.result.substr(a.result.indexOf(",")+1))},t&&a.readAsDataURL(t)};return te()(document.querySelector("textarea")),o.a.createElement("form",{className:"commentForm"},o.a.createElement("label",null,o.a.createElement("img",{src:ne.a,alt:"sendImage"}),o.a.createElement("input",{className:"commentForm__imageInput",type:"file",onChange:function(e){return _(e)}})),o.a.createElement("textarea",{autoFocus:t,rows:"1",wrap:"hard",placeholder:"Napisz komentarz...",className:"commentForm__textInput",onChange:function(e){return p(e.target.value)},value:u,onKeyPress:function(e){return"Enter"===e.key?f(e):null}}),o.a.createElement("button",{className:"commentForm__submit",onClick:function(e){return f(e)}},"\u2332"))}),se=(a(110),function(e){var t=e.comment;return o.a.createElement("li",{className:"comment"},o.a.createElement("img",{src:V.a,alt:"sex",className:"comment__sex"}),o.a.createElement("div",{className:"comment__text"},o.a.createElement("span",{className:"comment__username"},t.username),"\xa0",t.commentText),"\xa0",t.image?o.a.createElement("a",{href:t.image.large,rel:"noopener noreferrer",target:"_blank"},"Obraz"):null)}),ce=(a(111),function(e){var t=e.post,a=e.focus,s=e.postComments,c=e.forceUpdatePost,r=Object(k.d)((function(e){return e.socket})),l=z()();return Object(n.useEffect)((function(){r&&r.on("comment",(function(){l()}))}),[r,l]),window.onhashchange=function(){c()},o.a.createElement("div",{className:"comments"},o.a.createElement("div",{className:"comments__topBar"},o.a.createElement("button",{type:"button",onClick:function(){window.history.back()}},o.a.createElement("img",{src:Q.a,alt:"back",className:"comments__backButtonImg"})),o.a.createElement("div",{className:"comments__title"},"Komentarze")),o.a.createElement("ul",{className:"comments__list"},s.slice(0).reverse().map((function(e){return o.a.createElement(se,{key:e._id,comment:e})}))),o.a.createElement(oe,{focus:a,post:t}))});ce.defaultProps={focus:!1};var re=ce,le=(a(112),function(e){var t=e.post,a=Object(k.d)((function(e){return e.socket})),s=Object(n.useState)(0),c=Object(O.a)(s,2),r=c[0],l=c[1],i=z()(),m=t.comments,u=t.image,p=t.body,d=t.createdAt,f=t.username,_=t._id;return Object(n.useEffect)((function(){try{l(m.length)}catch(e){l(0)}}),[m.length]),Object(n.useEffect)((function(){a.on("comment",(function(e){_===e.postId&&(l(m.length+1),m.push(e),i())}))}),[m,a,_,i]),o.a.createElement("li",{className:"post"},o.a.createElement("img",{src:V.a,alt:"sex",className:"post__sex"}),o.a.createElement("div",{className:"post__content"},o.a.createElement("div",{className:"post__username"},f),o.a.createElement("div",{className:"post__postDate"},Y(d)),o.a.createElement("div",{className:"post__body"},p),u?o.a.createElement("img",{className:"post__image",src:u.medium,alt:""}):null,o.a.createElement("div",{className:"post__buttons"},o.a.createElement("button",{type:"button",className:"post__like"},"+1"),o.a.createElement("button",{type:"button",className:"post__dislike"},"-1"),o.a.createElement("button",{type:"button",className:"post__commentsButton",onClick:function(){window.location.hash="comments",i()}},0===r?"Napisz komentarz":"Komentarze ".concat(r)))),o.a.createElement("button",{type:"button",className:"post__reportButton"},o.a.createElement("img",{src:X.a,alt:"report"})),o.a.createElement("div",{className:"post__bottom"},o.a.createElement("hr",{className:"post__hr"}),o.a.createElement("div",null,o.a.createElement("div",{className:"post__votes"},o.a.createElement("span",{className:"post__reactions"},"13"),o.a.createElement("span",null,"\xa0szop\xf3w jest za, a\xa0"),o.a.createElement("span",{className:"post__reactions"},"5"),o.a.createElement("span",null,"\xa0przeciw")),o.a.createElement("ul",{className:"post__comments"},m.slice(0).reverse().slice(0,3).map((function(e){return o.a.createElement("li",{key:e._id},o.a.createElement("span",{className:"post__username"},e.username)," ",e.commentText)})),r>3?o.a.createElement("li",null,o.a.createElement("button",{type:"button",className:"post__showAllButton",onClick:function(){window.location.hash="comments",i()}},"Zobacz wszystkie")):null))),"#comments"===window.location.hash?o.a.createElement(re,{forceUpdatePost:i,post:t,postComments:m,focus:0===r}):null)}),ie=(a(113),function(e){var t=e.postType,a=e.posts,n=!1,s=Object(k.d)((function(e){return e.socket}));return Object(K.useScrollPosition)((function(e){var t=e.currPos,o=document.body.offsetHeight-window.innerHeight+t.y;!n&&o<0&&(s.emit("getMorePosts",a.postsLastId),n=!0)}),[a],null,!1,300),o.a.createElement("ul",{className:"posts"},a[t].map((function(e){return o.a.createElement(le,{key:e._id,post:e})})))});ie.defaultProps={postType:"posts"};var me=Object(k.b)((function(e){return e}))(ie),ue=a(54),pe=a.n(ue),de=a(55),fe=a.n(de),_e=a(56),ge=a.n(_e),he=a(57),be=a.n(he),Ee=a(58),ve=a.n(Ee),we=a(59),Ne=a.n(we),ye=(a(114),function(e){var t=e.setCreatePostFrom,a=Object(n.useState)(""),s=Object(O.a)(a,2),c=s[0],r=s[1],l=Object(n.useState)(""),i=Object(O.a)(l,2),m=i[0],u=i[1],p=Object(k.d)((function(e){return e.socket})),d=function(){var e=document.getElementById("file").files[0],t=new FileReader;t.onloadend=function(){!function(e){var t=new Headers;t.append("Content-Type","application/x-www-form-urlencoded");var a=new URLSearchParams;a.append("key","69106b72459a3015d3a83871dde47b63"),a.append("image",e),fetch("https://api.imgbb.com/1/upload",{method:"POST",headers:t,body:a,redirect:"follow"}).then((function(e){return e.json()})).then((function(e){return u({large:e.data.image.url,mini:e.data.thumb.url,medium:e.data.medium.url})})).catch((function(e){return console.log("error",e)}))}(t.result.substr(t.result.indexOf(",")+1))},e&&t.readAsDataURL(e)};return te()(document.querySelector("textarea")),o.a.createElement(fe.a,{axis:"y",handle:".createPostForm__handle"},o.a.createElement("div",{className:"createPostForm"},o.a.createElement("div",{className:"createPostForm__handle"},o.a.createElement("div",null,o.a.createElement("img",{className:"createPostForm__formIco",src:be.a,alt:"createPost"}),o.a.createElement("span",{className:"createPostForm__handleTitle"},"Utw\xf3rz post")),o.a.createElement("button",{type:"button",className:"createPostForm__closeButton",onClick:function(){t(!1)}},o.a.createElement("img",{src:ge.a,alt:"closeForm"}))),o.a.createElement("form",{action:"",className:"createPostForm__form"},o.a.createElement("div",{className:"createPostForm__label"},"Tre\u015b\u0107:"),o.a.createElement("textarea",{name:"body",className:"createPostForm__postBody",rows:"8",placeholder:"Nie ma to jak koronawirus x_x",onChange:function(e){return r(e.target.value)},value:c}),o.a.createElement("div",{className:"createPostForm__label"},"Obraz:"),o.a.createElement("label",{className:"createPostForm__labelButtonStyle",htmlFor:"image"},o.a.createElement("img",{src:""===m?ve.a:Ne.a,alt:"upload",className:"createPostForm__uploadImg"}),o.a.createElement("input",{className:"createPostForm__imageButton",name:"image",type:"file",accept:"image/x-png,image/jpeg",id:"file",onChange:function(){return d()}})),o.a.createElement("button",{type:"submit",className:"createPostForm__submit",onClick:function(e){return function(e){e.preventDefault();var a={body:c,image:m};a&&(p.emit("sendPost",a),t(!1))}(e)}},"Opublikuj"))))});ye.defaultProps={setCreatePostFrom:function(){return 0}};var ke=ye,Se=(a(115),function(){var e=Object(n.useState)(!1),t=Object(O.a)(e,2),a=t[0],s=t[1];return o.a.createElement("div",{className:"createPost"},a?o.a.createElement(ke,{setCreatePostFrom:s}):o.a.createElement("button",{type:"button",className:"createPost__button",onClick:function(){return s(!0)}},o.a.createElement("img",{src:pe.a,alt:""})))}),Oe=(a(116),function(e){var t=e.postType,a={display:"block"};return""!==window.location.hash?a.display="none":a.display="block",o.a.createElement("div",{style:a,className:"chan"},o.a.createElement(me,{postType:t}),o.a.createElement(Se,null))});Oe.defaultProps={postType:"posts"};var je=Oe,Pe=a(60),Te=a.n(Pe),Ce=a(17),xe=a.n(Ce),Ie=(a(117),function(e){var t=e.chatWith,a=e.setChatWith;return o.a.createElement("div",{className:"topBarChat"},o.a.createElement("button",{className:"topBarChat__backButton",onClick:function(){a(""),window.history.back()}},o.a.createElement("img",{src:R.a,alt:"back"})),o.a.createElement("div",{className:"topBarChat__title"},t),o.a.createElement("div",{className:"topBarChat__online"},o.a.createElement("div",{className:"topBarChat__onlineNumber"},"1"),o.a.createElement("img",{src:xe.a,alt:"online"})))}),Be=(a(118),function(e){var t=e.message,a=e.isMy;return o.a.createElement("div",{className:"message ".concat(a?"message--end":null)},o.a.createElement("div",{className:"message__speechBubble ".concat(a?"message__speechBubble--end":null)},t.body),o.a.createElement("div",{className:"message__username"},t.username))}),ze=(a(119),Object(k.b)((function(e){return e}))((function(e){var t=e.messages,a=!1,s=Object(k.d)((function(e){return e.socket})),c=Object(k.d)((function(e){return e.userInfo.username})),r=Object(n.useState)(!0),l=Object(O.a)(r,2),i=l[0],m=l[1];return Object(n.useEffect)((function(){var e=document.querySelector(".messages__scroll"),n=document.querySelector(".messages__loadMoreButton"),o=document.querySelectorAll(".message");if(e&&o.length>5){for(var s,c=0;c<5;c+=1)s=o[c].offsetHeight;setInterval((function(){var o=e.scrollTop;!a&&t.messages.length>14&&o<50&&(e.scrollTop=o+s,n.click())}),1e3)}}),[t]),Object(n.useEffect)((function(){var e=document.querySelectorAll(".message"),t=document.querySelector(".messages__scroll"),a=t.scrollHeight,n=t.scrollTop,o=t.offsetHeight;if(e.length>0){var s=a-n-o-e[e.length-1].offsetHeight-24;m(s<100)}i&&function(e){var t=document.querySelector("#bottom");"smooth"===e?t.scrollIntoView({behavior:"smooth"}):"fast"===e&&t.scrollIntoView()}("smooth")}),[t]),o.a.createElement("div",{className:"messages"},o.a.createElement("div",{className:"messages__scroll"},o.a.createElement("button",{type:"button",className:"messages__loadMoreButton",onClick:function(){return a=!0,void s.emit("getMoreMessages",t.messagesLastId)}}),t.messages.map((function(e){return o.a.createElement(Be,{key:e._id,message:e,isMy:e.username===c})})),o.a.createElement("div",{id:"bottom"})))}))),Me=a(61),Fe=a.n(Me),De=(a(120),function(){var e=Object(k.d)((function(e){return e.socket})),t=Object(n.useState)(""),a=Object(O.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)(""),l=Object(O.a)(r,2),i=l[0],m=l[1];te()(document.querySelector(".messageForm__textarea"));var u=function(t){t.preventDefault();var a={messageText:s,messageImage:i};e.emit("sendMessage",a),c("")};return o.a.createElement("div",{className:"messageForm"},o.a.createElement("button",{type:"button",className:"messageForm__sendImageButton",onClick:function(){return m("null")}},o.a.createElement("img",{src:ne.a,alt:""})),o.a.createElement("textarea",{className:"messageForm__textarea",rows:"1",wrap:"hard",placeholder:"Napisz wiadomo\u015b\u0107...",onChange:function(e){return c(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?u(e):null},value:s,onFocus:function(){document.querySelector("#bottom").scrollIntoView()}}),o.a.createElement("button",{type:"button",className:"messageForm__sendMessageButton",onClick:function(e){return u(e)}},o.a.createElement("img",{src:Fe.a,alt:""})))}),We=(a(121),function(e){var t=e.chatWith,a=e.setChatWith;return o.a.createElement("div",{className:"conversation"},o.a.createElement(Ie,{chatWith:t,setChatWith:a}),o.a.createElement(ze,{chatWith:t}),o.a.createElement(De,{chatWith:t}))});We.defaultProps={chatWith:"all",setChatWith:function(){return 0}};var Ae=We,Le=(a(122),function(e){var t=e.forceUpdateMain,a=Object(n.useState)(""),s=Object(O.a)(a,2),c=s[0],r=s[1];return window.onhashchange=function(){t()},o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"chat"},o.a.createElement("button",{type:"button",className:"chat__all",onClick:function(){r("all"),window.location.hash+="/#all"}},o.a.createElement("div",{className:"chat__allHeader"},o.a.createElement("img",{src:Te.a,alt:"wtf"}),o.a.createElement("div",{className:"chat__allTitle"},"Wszyscy")),o.a.createElement("div",{className:"chat__allOnline"},o.a.createElement("div",{className:"chat__allOnlineNumber"},"0"),o.a.createElement("img",{src:xe.a,alt:""}))),o.a.createElement("ul",null,o.a.createElement("li",null,"Tu znajd\u0105 si\u0119 Twoje rozmowy z innymi szopami"))),c?o.a.createElement(Ae,{chatWith:c,setChatWith:r}):null)});Le.defaultProps={forceUpdateMain:null};var Ue=Le,Re=(a(123),function(e){var t=e.setMenu,a=e.setPostType,n=e.postType,s=Object(k.d)((function(e){return e.userInfo.username}));return o.a.createElement("aside",{className:"menu"},o.a.createElement("div",{className:"menu__content"},o.a.createElement("div",{className:"menu__header"},o.a.createElement("img",{src:V.a,alt:"profile",className:"menu__profile"}),"Witaj,\xa0",o.a.createElement("span",{className:"menu__username"},s)),o.a.createElement("div",{className:"menu__options"},o.a.createElement("button",{type:"button",className:"menu__option ".concat("posts"===n?"menu__option--chosen":null),onClick:function(){a("posts"),t(!1)}},"Tablica"),o.a.createElement("button",{type:"button",className:"menu__option ".concat("myPosts"===n?"menu__option--chosen":null),onClick:function(){a("myPosts"),t(!1)}},"Moje posty"),o.a.createElement("button",{type:"button",className:"menu__option ".concat("followingPosts"===n?"menu__option--chosen":null),onClick:function(){a("followingPosts"),t(!1)}},"Obserwowane"),o.a.createElement("button",{type:"button",className:"menu__option"},"Sklep"),o.a.createElement("button",{type:"button",className:"menu__option"},"Randka"),o.a.createElement("button",{type:"button",className:"menu__option"},"Ustawienia"),o.a.createElement("button",{type:"button",className:"menu__option menu__option--logout",onClick:function(){return localStorage.setItem("token",null),C("token","",0),void window.location.reload()}},"Wyloguj"))),o.a.createElement("div",{className:"menu__bg",onClick:function(){return t(!1)}}))});Re.defaultProps={postType:"posts"};var qe=Re,He=function(){var e=z()(),t=Object(n.useState)(!1),a=Object(O.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)("posts"),l=Object(O.a)(r,2),i=l[0],m=l[1];return window.onload=function(){window.location.hash=""},o.a.createElement("div",null,o.a.createElement(M,null),o.a.createElement(F,null),o.a.createElement(G,{setMenu:c,forceUpdateMain:e}),window.location.hash.indexOf("chat")>0?o.a.createElement(Ue,{forceUpdateMain:e}):null,s?o.a.createElement(qe,{setMenu:c,setPostType:m,postType:i}):null,o.a.createElement(je,{postType:i}))},Ge=a(30),Ke=a.n(Ge),Ze=function(){var e=Object(k.c)(),t=Object(k.d)((function(e){return e.socket})),a=Object(k.d)((function(e){return e.socket.connected}));Object(n.useEffect)((function(){t&&(t.on("error",(function(e){e&&localStorage.removeItem("token")})),t.on("connect",(function(){})),t.on("userInfo",(function(a){e({type:"SET_USER",user:a}),t.emit("joinChan",(function(e){}))})),t.on("connect_error",(function(){localStorage.removeItem("token")})))}),["https://schoolchan.herokuapp.com",e,t]);return o.a.createElement(o.a.Fragment,null,function(){if(Ke()()){if(a)return o.a.createElement(He,null);if(!a)return o.a.createElement(I,null)}if(!Ke()()){if(a)return"noMobileLogged";if(!a)return"noMobileNoLogged"}return null}())},Ve=Object(i.c)(y,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());l.a.render(o.a.createElement(k.a,{store:Ve},o.a.createElement(Ze,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):c(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):c(t,e)}))}}(),"serviceWorker"in navigator&&(console.log("Will the service worker register?"),navigator.serviceWorker.register("./serviceWorker.js").then((function(e){console.log("Yes, it did.")})).catch((function(e){console.log("No it didn't. This happened: ",e)})))}],[[62,1,2]]]);
//# sourceMappingURL=main.2dc11608.chunk.js.map